<div class="head-general-map">
  <h1> <span>LA CARTE DES BLOOMERS</span> </h1>
  <div class="row">
    <div class="container-map-marker-legend">
      <div class="col-xs-4 map-marker-legend-content">
        <img src="http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=I|04677D|000000" alt="map marker icon incubateur"> <h2>Incubateurs</h2>
      </div>
      <div class="col-xs-4 map-marker-legend-content">
        <img src="http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=A|FEC300|000000" alt="map marker icon accelerateur"> <h2>Accélérateurs</h2>
      </div>
      <div class="col-xs-4 map-marker-legend-content">
        <img src="http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=C|13CE66|000000" alt="map marker icon coworking"> <h2>Coworkings</h2>
      </div>
    </div>
  </div>
</div>

<!-- <div class="container"> -->
  <div id="map" style="width: 100%; height: 100vh;"></div>

  <% content_for(:after_js) do %>
  <%= javascript_tag do %>

  $(document).ready(function() {
    var mapStyle = [
      {"featureType": "landscape.natural",
      "elementType": "geometry.fill",
      "stylers": [{
      "visibility": "on"},
      {"color": "#e0efef"
      }]},
      {"featureType": "poi",
      "elementType": "geometry.fill",
      "stylers": [
      {"visibility": "on"
      },
      {"hue": "#1900ff"
      },
      {"color": "#c0e8e8"
      }]},
      {"featureType": "road", "elementType": "geometry", "stylers": [
        {"lightness": 100},
        {"visibility": "simplified"}]},
      {
        "featureType": "road",
        "elementType": "labels",
        "stylers": [
        {
        "visibility": "off"
      }]},
      {
        "featureType": "road.local",
        "elementType": "labels.text",
        "stylers": [
        {
        "visibility": "on"
      }]},
      {
        "featureType": "transit.line",
        "elementType": "geometry",
        "stylers": [
        {
        "visibility": "on"
      },
      {
        "lightness": 700
      }]},
      {
        "featureType": "water",
        "elementType": "all",
        "stylers": [
        {
        "color": "#7dcdcd"
      }]}];

      var handler = Gmaps.build('Google');
      handler.buildMap({
      internal: { id: 'map' },
      provider: {
      scrollwheel: false,
      <!-- zoomControl: false, -->
      styles: mapStyle
      }
      },
  function() {
    markers = handler.addMarkers(<%= raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    if (markers.length == 0) {
    handler.getMap().setZoom(2);
    } else if (markers.length == 1) {
    handler.getMap().setZoom(14);
    }
  });
  });
<% end %>
<% end %>
</div>
